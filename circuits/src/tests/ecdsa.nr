use crate::ecdsa_verification;

#[test]
fn test_works_1() {
    let pub_x_key = [
        20, 115, 2, 219, 16, 67, 235, 60, 114, 224, 86, 182, 130, 209, 45, 121, 193, 37, 34, 177, 77, 63, 112, 232, 105, 64, 204, 14, 45, 161, 98, 194
    ];
    let pub_y_key = [
        149, 206, 173, 115, 200, 3, 116, 122, 53, 108, 181, 90, 34, 39, 175, 226, 140, 75, 137, 65, 69, 37, 153, 85, 157, 94, 78, 48, 100, 211, 237, 68
    ];
    let signature = [
        13, 198, 194, 77, 213, 8, 32, 204, 103, 48, 101, 221, 20, 180, 154, 38, 250, 72, 212, 135, 31, 130, 121, 37, 86, 215, 136, 220, 26, 236, 60, 247, 58, 251, 115, 182, 27, 145, 189, 251, 135, 246, 186, 170, 129, 144, 217, 159, 80, 79, 88, 96, 213, 118, 29, 130, 68, 242, 229, 104, 111, 98, 209, 64
    ];
    let hash = [
        92, 166, 250, 182, 89, 67, 26, 188, 223, 252, 226, 156, 135, 232, 82, 220, 197, 208, 62, 156, 161, 52, 127, 195, 216, 205, 251, 200, 7, 15, 219, 118
    ];
    ecdsa_verification(pub_x_key, pub_y_key, signature, hash);
}

#[test]
fn test_works_2() {
    let pub_x_key = [
        20, 115, 2, 219, 16, 67, 235, 60, 114, 224, 86, 182, 130, 209, 45, 121, 193, 37, 34, 177, 77, 63, 112, 232, 105, 64, 204, 14, 45, 161, 98, 194
    ];
    let pub_y_key = [
        149, 206, 173, 115, 200, 3, 116, 122, 53, 108, 181, 90, 34, 39, 175, 226, 140, 75, 137, 65, 69, 37, 153, 85, 157, 94, 78, 48, 100, 211, 237, 68
    ];
    let signature = [
        13, 198, 194, 77, 213, 8, 32, 204, 103, 48, 101, 221, 20, 180, 154, 38, 250, 72, 212, 135, 31, 130, 121, 37, 86, 215, 136, 220, 26, 236, 60, 247, 58, 251, 115, 182, 27, 145, 189, 251, 135, 246, 186, 170, 129, 144, 217, 159, 80, 79, 88, 96, 213, 118, 29, 130, 68, 242, 229, 104, 111, 98, 209, 64
    ];
    let hash = [
        92, 166, 250, 182, 89, 67, 26, 188, 223, 252, 226, 156, 135, 232, 82, 220, 197, 208, 62, 156, 161, 52, 127, 195, 216, 205, 251, 200, 7, 15, 219, 118
    ];
    ecdsa_verification(pub_x_key, pub_y_key, signature, hash);
}

#[test(should_fail)]
fn test_fails() {
    let pub_x_key = [
        20, 115, 1, 219, 16, 67, 235, 60, 114, 224, 86, 182, 130, 209, 45, 121, 193, 37, 34, 177, 77, 63, 112, 232, 105, 64, 204, 14, 45, 161, 98, 194
    ];
    let pub_y_key = [
        149, 206, 173, 115, 200, 3, 116, 122, 53, 108, 181, 90, 34, 39, 175, 226, 140, 75, 137, 65, 69, 37, 153, 85, 157, 94, 78, 48, 100, 211, 237, 68
    ];
    let signature = [
        13, 198, 194, 77, 212, 8, 32, 204, 103, 48, 101, 221, 20, 180, 154, 38, 250, 72, 212, 135, 31, 130, 121, 37, 86, 215, 136, 220, 26, 236, 60, 247, 58, 251, 115, 182, 27, 145, 189, 251, 135, 246, 186, 170, 129, 144, 217, 159, 80, 79, 88, 96, 213, 118, 29, 130, 68, 242, 229, 104, 111, 98, 209, 64
    ];
    let hash = [
        92, 166, 250, 182, 89, 67, 26, 188, 223, 252, 226, 156, 135, 232, 82, 220, 197, 208, 62, 156, 161, 52, 127, 195, 216, 205, 251, 200, 7, 15, 219, 118
    ];
    ecdsa_verification(pub_x_key, pub_y_key, signature, hash);
}
